{"version":3,"sources":["../../src/AuthCodeFunctions.tsx","../../src/AuthCodeLoader.tsx","../../src/AuthCodeMessage.tsx","../../src/AuthCodeProvider.tsx","FunctionsPage.tsx","App.tsx","index.tsx"],"names":["cookies","Cookies","crypto","require","hasTokenExpired","storagePrefix","tokenExpired","accessTokenExpiry","localStorage","getItem","now","Date","accessTokenExpiryDate","hasAccessToken","accessToken","get","hasRefreshToken","refreshToken","doAuthorizationCodeFlow","authenticationProps","returnTo","isretry","remove","removeItem","postAuthenticationRedirect","window","location","pathname","search","setItem","codeLocation","getCodeLocation","replace","authUrl","callBackPath","clientId","scope","usePkce","useState","useNonce","url","encodeURIComponent","buildRedirectUri","verifier","base64URLEncode","randomBytes","challenge","sha256","state","nonce","doLogoutFlow","redirectURI","logoutCallBackPath","logoutUrl","path","pathMod","toUpperCase","includes","protocol","host","str","toString","buffer","createHash","update","digest","getURIParameterByName","name","results","RegExp","exec","decodeURIComponent","parseJwt","token","base64","split","atob","map","c","charCodeAt","slice","join","requestHeaders","Authorization","Loader","props","React","className","styles","style","text","Message","onBtnClick","marginTop","onClick","btnText","qs","initialState","loading","signinError","AuthCodeProvider","constructor","retryAuth","bind","componentDidMount","this","doLogout","processAuth","componentDidUpdate","prevProps","authenticationRequired","componentWillUnmount","refreshTimer","clearInterval","isRefresh","debugit","diffMs","valueOf","setTokenRefresh","AuthCodeFunctions","setState","doRefreshFlow","sessionExpired","code","href","onReceiveAuthCode","tradeCodeForToken","getAuthCode","onGetAuthCode","tokenUrl","clientSecret","codeState","origState","stateErr","console","log","onTokenObtainedError","Error","params","grant_type","client_id","redirect_uri","client_secret","code_verifier","axios","post","stringify","headers","then","response","data","access_token","error","error_description","setTokens","onTokenObtained","catch","refresh_token","onTokenRefreshed","onTokenRefreshedError","confirm","refreshErrorText","setTimeout","isrefresh","idToken","id_token","origNonce","idTokenObj","JSON","parse","expiryMins","expires_in","expiryDate","getTime","set","cookiePath","expires","setMonth","getMonth","redirectpath","history","substring","indexOf","expiryMilliSecs","line","enableDebugLog","render","signInErrorComponent","signInErrorText","loadertext","signOutText","signInText","loaderComponent","children","PropTypes","bool","object","isRequired","string","any","func","FunctionsPage","userInfoLoading","setUserInfoLoading","userInfo","setUserInfo","loggedIn","isLoggedIn","authProps","disabled","signRequest","withRouter","authRequired","setAuthRequired","setDoLogout","setTokenLoaded","username","e","loginstatus","pageinfo","type","data-toggle","data-target","aria-controls","aria-expanded","aria-label","width","id","to","exact","fontStyle","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.fd1e56cd.chunk.js","sourcesContent":["import Cookies from 'universal-cookie'\n// eslint-disable-next-line no-unused-vars\nimport AuthCodeProps from './AuthCodeProps'\n\nconst cookies = new Cookies()\nconst crypto = require('crypto')\n\n/**\n * Returns true if there is a an access_token or refresh_token cookie present\n * (IE. authorization has been completed)\n */\nexport function isLoggedIn(storagePrefix: string = ''): boolean {\n  if (hasRefreshToken(storagePrefix)) {\n    return true\n  } else if (hasAccessToken(storagePrefix) && !hasTokenExpired(storagePrefix)) {\n    return true\n  }\n  return false\n}\n\n/**\n * Determines if the current access_token is still valid (2 minute leeway)\n */\nexport function hasTokenExpired(storagePrefix: string = ''): boolean {\n  let tokenExpired: boolean = false\n  const accessTokenExpiry: any = localStorage.getItem(\n    storagePrefix + 'access_token_expiry'\n  )\n  if (accessTokenExpiry) {\n    var now = new Date()\n    const accessTokenExpiryDate = new Date(accessTokenExpiry)\n    if (now >= accessTokenExpiryDate) {\n      tokenExpired = true\n    }\n  }\n  return tokenExpired\n}\n\n/**\n * Returns true if there is an access token cookie present\n */\nexport function hasAccessToken(storagePrefix: string = ''): boolean {\n  return !!accessToken(storagePrefix)\n}\n\n/**\n * Returns the access_token which is saved as a cookie\n */\nexport function accessToken(storagePrefix: string = ''): string {\n  return cookies.get(storagePrefix + 'access_token')\n}\n\n/**\n * Returns true if there is a refresh token cookie present\n */\nexport function hasRefreshToken(storagePrefix: string = ''): boolean {\n  return !!refreshToken(storagePrefix)\n}\n\n/**\n * Returns the refresh_token which is saved as a cookie\n */\nexport function refreshToken(storagePrefix: string = ''): string {\n  return cookies.get(storagePrefix + 'refresh_token')\n}\n\n/**\n * Adds Authorization = 'Bearer access_token' to request headers if an access_token is present\n * @requestHeaders An object containing the headers of the request to be sent\n */\nexport function signRequest(\n  requestHeaders: any,\n  storagePrefix: string = ''\n): any {\n  if (!requestHeaders) {\n    requestHeaders = {}\n  }\n  const token = accessToken(storagePrefix)\n  if (token) {\n    requestHeaders.Authorization = 'Bearer ' + token\n  }\n  return requestHeaders\n}\n\n/**\n * Begins authorization by redirecting to the authorization endpoint of the authentication server\n * @authenticationProps An object containing authentication properties\n * @returnTo The path to go back to after authorization has been completed. If not set it will use the current path\n */\nexport function doAuthorizationCodeFlow(\n  authenticationProps: AuthCodeProps,\n  returnTo: string | null = null,\n  storagePrefix: string = '',\n  isretry: boolean = false\n): void {\n  cookies.remove(storagePrefix + 'access_token')\n  cookies.remove(storagePrefix + 'refresh_token')\n  localStorage.removeItem(storagePrefix + 'id_token')\n  if (\n    !isretry ||\n    !localStorage.getItem(storagePrefix + 'authcode_authentication_redirect')\n  ) {\n    let postAuthenticationRedirect = returnTo\n    if (postAuthenticationRedirect == null) {\n      postAuthenticationRedirect =\n        window.location.pathname + window.location.search\n    }\n    localStorage.setItem(\n      storagePrefix + 'authcode_authentication_redirect',\n      postAuthenticationRedirect\n    )\n  }\n  const codeLocation = getCodeLocation(authenticationProps, storagePrefix)\n  window.location.replace(codeLocation)\n}\n\nfunction getCodeLocation(\n  authenticationProps: AuthCodeProps,\n  storagePrefix: string = ''\n): string {\n  const {\n    authUrl,\n    callBackPath,\n    clientId,\n    scope,\n    usePkce,\n    useState,\n    useNonce\n  } = authenticationProps\n\n  let url = authUrl\n  url += '?client_id=' + clientId\n  url += '&response_type=code'\n  if (scope) {\n    url += '&scope=' + encodeURIComponent(scope)\n  }\n\n  url += '&redirect_uri=' + encodeURIComponent(buildRedirectUri(callBackPath))\n\n  if (usePkce) {\n    const verifier = base64URLEncode(crypto.randomBytes(32))\n    const challenge = base64URLEncode(sha256(verifier))\n    localStorage.setItem(storagePrefix + 'authcode_v', verifier)\n\n    url += '&code_challenge=' + challenge\n    url += '&code_challenge_method=S256'\n  } else {\n    localStorage.removeItem(storagePrefix + 'authcode_v')\n  }\n\n  if (useState) {\n    const state = base64URLEncode(crypto.randomBytes(32))\n    localStorage.setItem(storagePrefix + 'authcode_state', state)\n\n    url += '&state=' + state\n  } else {\n    localStorage.removeItem(storagePrefix + 'authcode_state')\n  }\n\n  if (useNonce) {\n    const nonce = base64URLEncode(crypto.randomBytes(32))\n    localStorage.setItem(storagePrefix + 'authcode_nonce', nonce)\n\n    url += '&nonce=' + nonce\n  } else {\n    localStorage.removeItem(storagePrefix + 'authcode_nonce')\n  }\n\n  return url\n}\n\n/**\n * Begins logout by redirecting to the logout endpoint of the authentication server\n * @authenticationProps An object containing authentication properties\n */\nexport function doLogoutFlow(\n  authenticationProps: AuthCodeProps,\n  storagePrefix: string = ''\n): void {\n  cookies.remove(storagePrefix + 'access_token')\n  cookies.remove(storagePrefix + 'refresh_token')\n  localStorage.removeItem(storagePrefix + 'id_token')\n\n  const redirectURI = encodeURIComponent(\n    buildRedirectUri(\n      authenticationProps.logoutCallBackPath == null\n        ? ''\n        : authenticationProps.logoutCallBackPath\n    )\n  )\n  window.location.replace(\n    authenticationProps.logoutUrl +\n      '?post_logout_redirect_uri=' +\n      redirectURI +\n      '&returnTo=' +\n      redirectURI +\n      '&client_id=' +\n      authenticationProps.clientId\n  )\n}\n\n/**\n * Gets the full redirectUri from a path name\n */\nexport function buildRedirectUri(path: string): string {\n  let pathMod = path\n  if (!pathMod) {\n    pathMod = ''\n  }\n  if (\n    pathMod.toUpperCase().includes('HTTP://') ||\n    pathMod.toUpperCase().includes('HTTPS://')\n  ) {\n    return pathMod\n  } else {\n    return location.protocol + '//' + location.host + pathMod\n  }\n}\n\n/**\n * base64 encodes a url\n * @str url\n * @returns string - base64 encoded url\n */\nexport function base64URLEncode(str: any): string {\n  return str\n    .toString('base64')\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_')\n    .replace(/=/g, '')\n}\n\n/**\n * sha256 encodes a string\n * @buffer string\n * @returns string - sha256 encoded version of buffer\n */\nexport function sha256(buffer: string): string {\n  return crypto.createHash('sha256').update(buffer).digest()\n}\n\n/**\n * Gets the value of a uri parameter\n * @name string - the name of the parameter\n * @url string - the url to get the parameter value from\n */\nexport function getURIParameterByName(name: string, url: string) {\n  name = name.replace(/[[\\]]/g, '\\\\$&')\n  const regex = new RegExp('[?&#]' + name + '(=([^&#]*)|&|#|$)')\n  const results = regex.exec(url)\n  if (!results) return null\n  if (!results[2]) return ''\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '))\n}\n\n/**\n * Decode Jwt to json string\n * @token id_token\n */\nexport function parseJwt(token: string): string {\n  var base64Url = token.split('.')[1];\n  var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n  var jsonPayload = decodeURIComponent(\n    atob(base64)\n      .split('')\n      .map(function (c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)\n      })\n      .join('')\n  )\n  return jsonPayload\n}\n","import React from 'react'\nimport styles from './styles.module.css'\n\ninterface ILoaderProps {\n  text?: string\n  styles?: any\n}\n\nconst Loader = (props: ILoaderProps) => {\n  return (\n    <div className={styles['loader-box']} style={props.styles}>\n      <div className={styles['pulse-container']}>\n        <div\n          className={styles['pulse-bubble'] + ' ' + styles['pulse-bubble-1']}\n        />\n        <div\n          className={styles['pulse-bubble'] + ' ' + styles['pulse-bubble-2']}\n        />\n        <div\n          className={styles['pulse-bubble'] + ' ' + styles['pulse-bubble-3']}\n        />\n      </div>\n      {props.text ? (\n        <div className={styles['loader-text']}>{props.text}</div>\n      ) : null}\n    </div>\n  )\n}\n\nexport default Loader\n","import React from 'react'\nimport styles from './styles.module.css'\n\ninterface ILoaderProps {\n  text?: string\n  styles?: any\n  btnText?: string\n  onBtnClick?: () => void\n}\n\nconst Message = (props: ILoaderProps) => {\n  return (\n    <div className={styles['loader-box']} style={props.styles}>\n      {props.text ? (\n        <div className={styles['loader-text']}>\n          {props.text}\n          {props.onBtnClick ? (\n            <div>\n              <button\n                className='btn btn-primary'\n                style={{ marginTop: '15px' }}\n                onClick={props.onBtnClick}\n              >\n                {props.btnText}\n              </button>\n            </div>\n          ) : null}\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nexport default Message\n","import * as React from 'react'\nimport PropTypes from 'prop-types'\nimport Cookies from 'universal-cookie'\nimport axios from 'axios'\nimport * as AuthCodeFunctions from './AuthCodeFunctions'\n// eslint-disable-next-line no-unused-vars\nimport AuthCodeProps from './AuthCodeProps'\nimport Loader from './AuthCodeLoader'\nimport Message from './AuthCodeMessage'\n\nconst cookies = new Cookies()\nconst qs = require('querystring')\n\ninterface IAuthCodeProviderProps {\n  children?: any\n  authenticationRequired?: boolean\n  doLogout?: boolean\n  authenticationProps: AuthCodeProps\n  returnTo?: string\n  history: any\n  storagePrefix: string\n  cookiePath: string\n  onGetAuthCode?: () => void\n  onReceiveAuthCode?: (authcode: string) => void\n  onTokenObtained?: (data: any) => void\n  onTokenObtainedError?: (error: Error) => void\n  onTokenRefreshed?: (data: any) => void\n  onTokenRefreshedError?: (error: Error) => void\n  enableDebugLog?: boolean\n  signInText: string\n  signOutText: string\n  signInErrorText: string\n  refreshErrorText: string\n  loaderComponent?: (props: any) => JSX.Element\n  signInErrorComponent?: (props: any) => JSX.Element\n}\n\ninterface IAuthCodeProviderState {\n  loading: boolean\n  signinError: boolean\n}\n\nconst initialState: IAuthCodeProviderState = {\n  loading: true,\n  signinError: false\n}\n\nclass AuthCodeProvider extends React.Component<\n  IAuthCodeProviderProps,\n  IAuthCodeProviderState\n> {\n  static defaultProps = {\n    authenticationRequired: true,\n    doLogout: false,\n    storagePrefix: '',\n    cookiePath: '/',\n    enableDebugLog: false,\n    signInText: 'Signing you in...',\n    signOutText: 'Signing you out...',\n    signInErrorText:\n      'Sorry, we were unable to sign you in. Please try again later.',\n    refreshErrorText: 'Your session has expired.\\nSign in again to continue.'\n  }\n\n  static propTypes = {\n    /**\n     * A prop used to toggle whether authentication is required.\n     * If false children will be rendered.\n     * If true, children will only be rendered when authenticated.\n     * Changing from false to true can be used to start the authentication flow.\n     */\n    authenticationRequired: PropTypes.bool,\n\n    /**\n     * A prop used to begin the logout flow.\n     * Changing from false to true can be used to start the logout flow.\n     */\n    doLogout: PropTypes.bool,\n\n    /**\n     * An instance of the AuthCodeAuthentication class. This contains properties needed to for the authentication flow.\n     */\n    authenticationProps: PropTypes.object.isRequired,\n\n    /**\n     * Once a token has been retrieved this is the path to redirect back to. If not set it will redirect back to the current path.\n     */\n    returnTo: PropTypes.string,\n\n    /**\n     * React router history object. If set this will be used for post authentication redirects and removing the code parameter.\n     * If not provided the page will be reloaded to remove the code parameter and redirect.\n     */\n    history: PropTypes.any,\n\n    /**\n     * Used if you are aythenticating with multiple oauth2 servers, you can store multiple access tokens.\n     * The second/third/etc instance should have a unique prefixes.\n     */\n    storagePrefix: PropTypes.string,\n\n    /**\n     * Determines the Path for cookies. If hosting in a subdirectory you should set this to the subdirectory path (/subdriectory)\n     */\n    cookiePath: PropTypes.string,\n\n    /**\n     * A call back function that is called before being redirecting to the authorization endpoint.\n     */\n    onGetAuthCode: PropTypes.func,\n\n    /**\n     * A call back function that is called when redirected back to the application with the Code parameter populated.\n     */\n    onReceiveAuthCode: PropTypes.func,\n\n    /**\n     * A call back function that is called after retrieving an access token.\n     */\n    onTokenObtained: PropTypes.func,\n\n    /**\n     * A call back function that is called if there is an error retrieving an access token.\n     */\n    onTokenObtainedError: PropTypes.func,\n\n    /**\n     * A call back function that is called after retrieving an access token from a refresh token in the background.\n     */\n    onTokenRefreshed: PropTypes.func,\n\n    /**\n     * A call back function that is called if there is an error retrieving access token from a refresh token in the background.\n     */\n    onTokenRefreshedError: PropTypes.func,\n\n    /**\n     * Set to true to allow addiitonal logging to the console\n     */\n    enableDebugLog: PropTypes.bool,\n\n    /**\n     * The label 'Signing you in'\n     */\n    signInText: PropTypes.string,\n\n    /**\n     * The label 'Signing you out'\n     */\n    signOutText: PropTypes.string,\n\n    /**\n     * The label 'Sorry, we were unable to sign you in. Please try again later.'\n     */\n    signInErrorText: PropTypes.string,\n\n    /**\n     * The label 'Your session has expired.\\nSign in again to continue.'\n     */\n    refreshErrorText: PropTypes.string,\n\n    /**\n     * You can use this prop to override the Loader with your own component.\n     * The component must support the props: text<string>.\n     */\n    loaderComponent: PropTypes.any,\n\n    /**\n     * You can use this prop to override the Sign in error message with your own component.\n     * The component must support the props: text<string>, btnText<string>, onBtnClick<function>.\n     */\n    signInErrorComponent: PropTypes.any\n  }\n\n  refreshTimer: any\n\n  constructor(props: IAuthCodeProviderProps) {\n    super(props)\n    this.state = initialState\n    this.retryAuth = this.retryAuth.bind(this)\n  }\n\n  componentDidMount() {\n    if (this.props.doLogout) {\n      this.doLogout()\n    } else {\n      this.processAuth(false)\n    }\n  }\n\n  componentDidUpdate(prevProps: IAuthCodeProviderProps): void {\n    if (this.props.doLogout && !prevProps.doLogout) {\n      this.doLogout()\n    } else if (\n      this.props.authenticationRequired &&\n      !prevProps.authenticationRequired\n    ) {\n      this.processAuth(false)\n    }\n  }\n\n  componentWillUnmount() {\n    // Clean up\n    if (this.refreshTimer) {\n      clearInterval(this.refreshTimer)\n      this.refreshTimer = null\n    }\n  }\n\n  /**\n   * Checks to see if any action is required to authenticate, and iniates it if neccessary.\n   */\n  private processAuth(isRefresh: boolean): void {\n    this.debugit('Authentication Required')\n    let tokenExpired: boolean = false\n    const accessTokenExpiry: any = localStorage.getItem(\n      this.props.storagePrefix + 'access_token_expiry'\n    )\n    if (accessTokenExpiry) {\n      var now = new Date()\n      const accessTokenExpiryDate = new Date(accessTokenExpiry)\n      if (now >= accessTokenExpiryDate) {\n        tokenExpired = true\n      } else {\n        const diffMs = accessTokenExpiryDate.valueOf() - now.valueOf()\n        this.setTokenRefresh(diffMs)\n      }\n    }\n\n    if (\n      AuthCodeFunctions.hasAccessToken(this.props.storagePrefix) &&\n      !tokenExpired\n    ) {\n      // We have an access token already, no need to do anything\n      this.debugit(\n        'Access token present and valid. Expiry = ' + accessTokenExpiry\n      )\n      if (this.state.loading) {\n        this.setState({ loading: false })\n      }\n    } else if (AuthCodeFunctions.hasRefreshToken(this.props.storagePrefix)) {\n      // We have a refresh token but no access token, use this to get a new access token\n      this.debugit('Refresh token present. Feteching new access token')\n      this.doRefreshFlow(isRefresh)\n    } else if (isRefresh) {\n      // Encountered an issue - display error\n      this.sessionExpired()\n    } else {\n      const code = AuthCodeFunctions.getURIParameterByName(\n        'code',\n        window.location.href\n      )\n      if (code) {\n        // We have an authentication code, trade for token\n        this.debugit('Authentication code detected. Fetching token')\n        if (this.props.onReceiveAuthCode != null) {\n          this.props.onReceiveAuthCode(code)\n        }\n        this.tradeCodeForToken(code)\n      } else if (this.props.authenticationRequired) {\n        // We have nothing, time to get a code\n        this.debugit('Redirecting to authoisation endpoint')\n        this.getAuthCode()\n      } else {\n        // authentication not required\n        this.setState({ loading: false })\n      }\n    }\n  }\n\n  /**\n   * Iniates the logout flow\n   */\n  private doLogout(): void {\n    AuthCodeFunctions.doLogoutFlow(\n      this.props.authenticationProps,\n      this.props.storagePrefix\n    )\n  }\n\n  /**\n   * Sets up redirect to the authorization endpoint\n   * @param isretry set to true if this is the second/third/nth attempt after an error with the first\n   */\n  private getAuthCode(isretry: boolean = false): void {\n    if (this.props.onGetAuthCode != null) {\n      this.props.onGetAuthCode()\n    }\n    this.setState({ loading: true })\n    AuthCodeFunctions.doAuthorizationCodeFlow(\n      this.props.authenticationProps,\n      this.props.returnTo,\n      this.props.storagePrefix,\n      isretry\n    )\n  }\n\n  /**\n   * Trade the Code in the uri for a token using by doing a post to the token endpoint\n   * @param code the code from the code query string parameter\n   */\n  private tradeCodeForToken(code: string): void {\n    const {\n      tokenUrl,\n      callBackPath,\n      clientId,\n      clientSecret,\n      scope,\n      usePkce,\n      useState\n    } = this.props.authenticationProps\n    this.debugit('Code url: ' + window.location.href)\n\n    if (useState) {\n      const codeState = AuthCodeFunctions.getURIParameterByName(\n        'state',\n        window.location.href\n      )\n      const origState = localStorage.getItem(\n        this.props.storagePrefix + 'authcode_state'\n      )\n      if (codeState !== origState) {\n        const stateErr = 'State does not match'\n        this.debugit(stateErr)\n        console.log(stateErr)\n        if (this.props.onTokenObtainedError != null) {\n          this.props.onTokenObtainedError(new Error(stateErr))\n        }\n        this.setState({ signinError: true })\n      } else {\n        this.debugit('State matches ' + origState)\n      }\n      localStorage.removeItem(this.props.storagePrefix + 'authcode_state')\n    }\n\n    const params: any = {\n      grant_type: 'authorization_code',\n      client_id: clientId,\n      redirect_uri: AuthCodeFunctions.buildRedirectUri(callBackPath),\n      scope: scope,\n      code: code\n    }\n    if (clientSecret) {\n      params.client_secret = clientSecret\n    }\n    if (scope) {\n      params.scope = scope\n    }\n\n    if (usePkce) {\n      const verifier = localStorage.getItem(\n        this.props.storagePrefix + 'authcode_v'\n      )\n      if (verifier) {\n        params.code_verifier = verifier\n      }\n    }\n\n    axios\n      .post(tokenUrl, qs.stringify(params), {\n        headers: {\n          'content-type': 'application/x-www-form-urlencoded'\n        }\n      })\n      .then((response: any) => {\n        this.debugit('Access token response')\n        this.debugit(response)\n        if (!response.data || !response.data.access_token) {\n          throw new Error('Access token not present in token response')\n        }\n        if (response.data.error) {\n          throw new Error(response.data.error_description)\n        }\n\n        this.setTokens(response.data, false)\n\n        if (this.props.onTokenObtained != null) {\n          this.props.onTokenObtained(response.data)\n        }\n      })\n      .catch((error: any) => {\n        console.log(error)\n        this.debugit('Access token error')\n        this.debugit(error?.response)\n        if (this.props.onTokenObtainedError != null) {\n          this.props.onTokenObtainedError(error)\n        }\n        this.setState({ signinError: true })\n      })\n  }\n\n  /**\n   * Use the refresh token to obtain a new access token. Does a post to the token endpoints\n   * @param isRefresh if this is happening in the background (not initial fetch)\n   */\n  private doRefreshFlow(isRefresh: boolean): void {\n    const {\n      tokenUrl,\n      callBackPath,\n      clientId,\n      clientSecret,\n      scope\n    } = this.props.authenticationProps\n\n    const params: any = {\n      grant_type: 'refresh_token',\n      client_id: clientId,\n      redirect_uri: AuthCodeFunctions.buildRedirectUri(callBackPath),\n      scope: scope,\n      refresh_token: AuthCodeFunctions.refreshToken(this.props.storagePrefix)\n    }\n    if (clientSecret) {\n      params.client_secret = clientSecret\n    }\n    if (scope) {\n      params.scope = scope\n    }\n\n    axios\n      .post(tokenUrl, qs.stringify(params), {\n        headers: {\n          'content-type': 'application/x-www-form-urlencoded'\n        }\n      })\n      .then((response: any) => {\n        this.debugit('Refresh token response')\n        this.debugit(response)\n        if (!response.data || !response.data.access_token) {\n          throw new Error('Access token not present in token response')\n        }\n        if (response.data.error) {\n          throw new Error(response.data.error_description)\n        }\n\n        this.setTokens(response.data, true)\n\n        if (!isRefresh) {\n          if (this.props.onTokenObtained != null) {\n            this.props.onTokenObtained(response.data)\n          }\n        } else {\n          if (this.props.onTokenRefreshed != null) {\n            this.props.onTokenRefreshed(response.data)\n          }\n        }\n      })\n      .catch((error: any) => {\n        console.log(error)\n        this.debugit('Refresh token error')\n        this.debugit(error?.response)\n        if (!isRefresh) {\n          if (this.props.authenticationRequired) {\n            this.setState({ signinError: true })\n          } else {\n            this.setState({ loading: false })\n            cookies.remove(this.props.storagePrefix + 'refresh_token')\n            localStorage.removeItem(this.props.storagePrefix + 'id_token')\n          }\n          if (this.props.onTokenObtainedError != null) {\n            this.props.onTokenObtainedError(error)\n          }\n        } else {\n          if (this.props.onTokenRefreshedError != null) {\n            this.props.onTokenRefreshedError(error)\n          }\n        }\n      })\n  }\n\n  /**\n   * If token expires mid session, or refresh fails mid session, this is called to get the user to take action to re-authorize.\n   */\n  private sessionExpired(): void {\n    var expiredresult = window.confirm(this.props.refreshErrorText)\n    if (expiredresult) {\n      this.retryAuth()\n    } else {\n      setTimeout(this.processAuth.bind(this, true), 60000)\n    }\n  }\n\n  /**\n   * Handles token endpoint response and saves tokens\n   * @param response response from the token endpoint\n   * @param isrefresh if this is happening in the background (not initial fetch)\n   */\n  private setTokens(response: any, isrefresh: boolean): void {\n    // save id token in storage and check nonce\n    const idToken = response.id_token\n    if (idToken) {\n      const origNonce = localStorage.getItem(\n        this.props.storagePrefix + 'authcode_nonce'\n      )\n      if (this.props.authenticationProps.useNonce && origNonce) {\n        const idTokenObj = JSON.parse(AuthCodeFunctions.parseJwt(idToken))\n        if (idTokenObj) {\n          if (idTokenObj.nonce !== origNonce) {\n            console.log(idTokenObj)\n            this.debugit('Expected nonce ' + origNonce)\n            this.debugit('Actual nonce ' + idTokenObj.nonce)\n            throw new Error('Nonce does not match')\n          } else {\n            this.debugit('Nonce matches ' + origNonce)\n          }\n        }\n      }\n      if (origNonce) {\n        localStorage.removeItem(this.props.storagePrefix + 'authcode_nonce')\n      }\n\n      localStorage.setItem(this.props.storagePrefix + 'id_token', idToken)\n    }\n\n    let expiryMins = 60\n    if (response.expires_in) {\n      expiryMins = response.expires_in / 60\n    }\n    // We remove 2 minutes from the expiry to give a buffer for refresh\n    expiryMins = expiryMins - 2\n    if (expiryMins < 1) {\n      expiryMins = 1\n    }\n    this.debugit('Token expiry mins: ' + expiryMins)\n\n    const now = new Date()\n    const expiryDate = new Date(now.getTime() + expiryMins * 60000)\n    localStorage.setItem(\n      this.props.storagePrefix + 'access_token_expiry',\n      expiryDate.toString()\n    )\n\n    cookies.set(\n      this.props.storagePrefix + 'access_token',\n      response.access_token,\n      { path: this.props.cookiePath }\n    )\n    this.debugit('New Access Token: ' + response.access_token)\n\n    // update refresh token cookie\n    let refreshToken = response.refresh_token\n    if (!refreshToken) {\n      refreshToken = AuthCodeFunctions.refreshToken(this.props.storagePrefix)\n    }\n    if (refreshToken) {\n      cookies.set(this.props.storagePrefix + 'refresh_token', refreshToken, {\n        path: this.props.cookiePath,\n        expires: new Date(now.setMonth(now.getMonth() + 4))\n      })\n      this.debugit('New Refresh Token: ' + response.access_token)\n    }\n\n    this.setTokenRefresh(1 * 60 * 1000)\n\n    if (!isrefresh) {\n      // Remove Verifier\n      const verifier = localStorage.getItem(\n        this.props.storagePrefix + 'authcode_v'\n      )\n      if (verifier) {\n        localStorage.removeItem(this.props.storagePrefix + 'authcode_v')\n      }\n\n      // Redirect if set\n      let redirectpath = localStorage.getItem(\n        this.props.storagePrefix + 'authcode_authentication_redirect'\n      )\n      if (!redirectpath) {\n        redirectpath = ''\n      } else {\n        localStorage.removeItem(\n          this.props.storagePrefix + 'authcode_authentication_redirect'\n        )\n      }\n      if (this.props.history) {\n        this.props.history.replace({\n          pathname: redirectpath.includes('?')\n            ? redirectpath.substring(0, redirectpath.indexOf('?'))\n            : redirectpath,\n          search: redirectpath.includes('?')\n            ? redirectpath.substring(redirectpath.indexOf('?'))\n            : ''\n        })\n      } else {\n        window.location.replace(redirectpath)\n      }\n    }\n\n    if (this.state.loading) {\n      this.setState({ loading: false })\n    }\n  }\n\n  /**\n   * Does a set timeout to allow a refresh when the token expires\n   * @param expiryMilliSecs Milliseconds until token expiry minus 2 mins\n   */\n  private setTokenRefresh(expiryMilliSecs: number) {\n    // Set up refresh interval\n    if (this.refreshTimer) {\n      clearInterval(this.refreshTimer)\n      this.refreshTimer = null\n    }\n    this.refreshTimer = setTimeout(\n      this.processAuth.bind(this, true),\n      expiryMilliSecs\n    )\n  }\n\n  /**\n   * Retry the authorization if it has failed\n   */\n  private retryAuth(): void {\n    cookies.remove(this.props.storagePrefix + 'access_token')\n    cookies.remove(this.props.storagePrefix + 'refresh_token')\n    localStorage.removeItem(this.props.storagePrefix + 'id_token')\n    this.getAuthCode(true)\n  }\n\n  /**\n   * Log additional information\n   * @param line what to log\n   */\n  private debugit(line: string): void {\n    if (this.props.enableDebugLog) {\n      console.log(line)\n    }\n  }\n\n  render() {\n    if (this.state.signinError) {\n      return React.createElement(\n        this.props.signInErrorComponent\n          ? this.props.signInErrorComponent\n          : Message,\n        {\n          text: this.props.signInErrorText,\n          btnText: 'Retry',\n          onBtnClick: this.retryAuth\n        }\n      )\n    }\n\n    if (this.state.loading || this.props.doLogout) {\n      const loadertext = this.props.doLogout\n        ? this.props.signOutText\n        : this.props.signInText\n      return React.createElement(\n        this.props.loaderComponent ? this.props.loaderComponent : Loader,\n        { text: loadertext }\n      )\n    }\n\n    return this.props.children\n  }\n}\n\nexport default AuthCodeProvider\n","import React, { useState } from 'react'\nimport { AuthCodeFunctions } from 'react-oauth2-authcode-provider'\nimport axios from 'axios'\n\nconst FunctionsPage = (props: any) => {\n  const [userInfoLoading, setUserInfoLoading] = useState<boolean>(false)\n  const [userInfo, setUserInfo] = useState<any>(null)\n  const loggedIn = AuthCodeFunctions.isLoggedIn()\n\n  return (\n    <div>\n      <div className='mt-3 mb-3'>\n        <button className='btn btn-primary mr-3' onClick={() => AuthCodeFunctions.doAuthorizationCodeFlow(props.authProps)}>Start Authorization Code Flow</button>\n        <button className='btn btn-primary mr-3' onClick={() => AuthCodeFunctions.doLogoutFlow(props.authProps)}>Start Log out Flow</button>\n      </div>\n      <div className='mt-3 mb-3'>\n        <button className='btn btn-primary mr-3' disabled={!loggedIn} onClick={() => {\n          setUserInfoLoading(true)\n          axios\n          .post('https://dev-emf33n24.eu.auth0.com/userinfo', null, {\n            headers: AuthCodeFunctions.signRequest({\n              'content-type': 'application/json'\n            })\n          })\n          .then((response: any) => {\n            setUserInfoLoading(false)\n            setUserInfo(response)\n          })\n          .catch((error: any) => {\n            console.log(error)\n            setUserInfoLoading(false)\n            setUserInfo(error)\n          })\n        }}>Get User Info</button>\n        {userInfoLoading ? 'Loading...' : ''}\n        {userInfo && !userInfoLoading ? <div className='mt-2'>{userInfo?.data ? JSON.stringify(userInfo?.data) : 'Error'}</div> : ''}\n      </div>\n    </div>\n  )\n\n}\n\nexport default FunctionsPage\n","import React, { useState } from 'react'\nimport {\n  Switch,\n  Route,\n  Link,\n  withRouter\n} from 'react-router-dom'\nimport { AuthCodeProvider, AuthCodeFunctions, AuthCodeProps } from 'react-oauth2-authcode-provider'\nimport 'react-oauth2-authcode-provider/dist/index.css'\nimport FunctionsPage from './FunctionsPage'\n\nconst App = (props: any) => {\n  const [authRequired, setAuthRequired] = useState(false)\n  const [doLogout, setDoLogout] = useState(false)\n  const [, setTokenLoaded] = useState<any>(null) // This is being used to refresh the nav bar on sign in status change\n\n  const authProps: AuthCodeProps = {\n    authUrl: 'https://dev-emf33n24.eu.auth0.com/authorize',\n    callBackPath: '/callback',\n    tokenUrl: 'https://dev-emf33n24.eu.auth0.com/oauth/token',\n    logoutUrl: 'https://dev-emf33n24.eu.auth0.com/v2/logout',\n    logoutCallBackPath: '/',\n    clientId: '0ujnTs1Uynm6W83ygzbkuRkMhqdTrZ26',\n    clientSecret: 'DhYAsb9z9LxMDsZL3shPFaB90sCSqMptPaMU-EnB7fEUv-ECbMjqlvn6nQTOVoLG',\n    scope: 'openid profile email phone address offline_access',\n    usePkce: true,\n    useState: true,\n    useNonce: true\n  }\n\n  const loggedIn = AuthCodeFunctions.isLoggedIn()\n  let username = ''\n  const idToken = localStorage.getItem('id_token')\n  if (idToken) {\n    try { \n      const idTokenObj = JSON.parse(AuthCodeFunctions.parseJwt(idToken))\n      if (idTokenObj){\n        username = idTokenObj.name\n      } \n    } catch (e) {\n      /*invalid json*/\n    };\n  }\n\n  const loginstatus = \n    <div>\n      {'You '}\n      <b>{loggedIn ? 'are' : 'are not'}</b>\n      {' logged in'}\n      <b>{loggedIn && username ? ' as ' + username : ''}</b>\n      {'.'}\n    </div>\n\n  const pageinfo = \n    <div className='mt-4 mb-5'>\n      <hr className='mb-4' />\n      <p>\n        These examples use a example Auth0 authorization server.\n      </p>\n      <div className='row'>\n        <div className=\"col-lg-4\">\n          <div className=\"card h-100 m-1\">\n            <div className=\"card-body\">\n              <p>\n                The <b>No Auth page</b> does not require you to be logged in to access.\n                You can initiate the OAuth2 Authorization code flow by selecting the login button though.\n              </p>\n              <p>\n                It uses the AuthCodeProvider component with authenticationRequired = the state of whether the log in button has been pressed.\n              </p>\n            </div>\n          </div>\n        </div>\n        <div className=\"col-lg-4\">\n          <div className=\"card h-100 m-1\">\n            <div className=\"card-body\">\n              <p>\n                The <b>Auth Required page</b> requires you to be logged in to access.\n                Browsing too this page will initiate the OAuth2 Authorization code flow if you are not already logged in.\n              </p>\n              <p>\n                It uses the AuthCodeProvider component with authenticationRequired = true.\n              </p>\n              <p>\n                You can also use this implementation to require authentication for the whole application.\n                To require authentication for the whole application, render a single instance of AuthCodeProvider in a top level component (E.g App).\n              </p>\n            </div>\n          </div>\n        </div>\n        <div className=\"col-lg-4\">\n          <div className=\"card h-100 m-1\">\n            <div className=\"card-body\">\n              <p>\n                The <b>Functions page</b> has alternate methods to begin the Authorization code or Logout flows.\n                These methods use Functions to initiate the flow instead of parsing props to AuthCodeProvider.\n                This is useful for starting the flows in deep nested components instead of passing variables up the stack.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  \n  return (\n    <div>\n      <nav className='navbar navbar-expand-lg navbar-dark bg-secondary fixed-top'>\n          <button className='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarSupportedContent' aria-controls='navbarSupportedContent' aria-expanded='false' aria-label='Toggle navigation'>\n              <span className='navbar-toggler-icon'></span>\n          </button>\n          <div style={{width:'100%'}}>\n            <div className='collapse navbar-collapse' id='navbarSupportedContent'>\n                <ul className='navbar-nav ml-lg-5' data-toggle='collapse' data-target='.navbar-collapse.show'>\n                    <li className='nav-item mr-lg-3'>\n                        <Link className={props.location.pathname === '/' ? 'nav-link active' : 'nav-link'} to='/'>No Auth</Link>\n                    </li>\n                    <li className='nav-item mr-lg-3'>\n                        <Link className={props.location.pathname === '/authrequired' ? 'nav-link active' : 'nav-link'} to='/authrequired'>Auth Required</Link>\n                    </li>\n                    <li className='nav-item mr-lg-3'>\n                        <Link className={props.location.pathname === '/functions' ? 'nav-link active' : 'nav-link'} to='/functions'>Functions</Link>\n                    </li>\n                </ul>\n\n                { props.location.pathname === '/functions' ? '' :\n                  <ul className='navbar-nav ml-auto mr-lg-5' data-toggle='collapse' data-target='.navbar-collapse.show'>\n                      { loggedIn ? \n                      <li className='nav-item mr-lg-3'>\n                          <button className='nav-link btn btn-link' onClick={() => setDoLogout(true)}>Logout</button>\n                      </li>\n                      :\n                      <li className='nav-item mr-lg-3'>\n                          <button className='nav-link btn btn-link' onClick={() => setAuthRequired(true)}>Login</button>\n                      </li>\n                      }\n                  </ul>\n                }\n            </div>\n          </div>\n      </nav>\n      <div className='ml-lg-5 ml-3 mr-lg-5 mr-3' style={{marginTop: '100px'}}>\n          <h1 className='mb-3'>react oauth2 authcode provider examples</h1>\n          <Switch>\n            <Route exact path='/'>\n\n              <AuthCodeProvider\n                authenticationProps={authProps}\n                history={props.history}\n                authenticationRequired={authRequired}\n                doLogout={doLogout}\n                enableDebugLog={true}\n                onTokenObtained={(data) => setTokenLoaded(data)}\n                onTokenObtainedError={(error) => { setTokenLoaded(error)}}\n              >\n                <h3>No Auth</h3>\n                <span style={{fontStyle: 'italic'}}>\n                  This page does not require you to be logged in, but you can log in with the login button on the nav bar.\n                </span>\n                {loginstatus}\n                {pageinfo}\n              </AuthCodeProvider>\n\n            </Route>\n            <Route exact path='/functions'>\n\n              <AuthCodeProvider\n                authenticationProps={authProps}\n                history={props.history}\n                authenticationRequired={false}\n                enableDebugLog={true}\n                onTokenObtained={(data) => setTokenLoaded(data)}\n                onTokenObtainedError={(error) => { setTokenLoaded(error)}}\n              >\n                <h3>Functions</h3>\n                <span style={{fontStyle: 'italic'}}>\n                  This page has functions to manually initiate the Authorization code flow or logout flow using functions.\n                </span>\n                {loginstatus}\n                <FunctionsPage authProps={authProps} />\n                {pageinfo}\n              </AuthCodeProvider>\n\n            </Route>\n            <Route exact path='*'>\n\n              <AuthCodeProvider\n                authenticationProps={authProps}\n                history={props.history}\n                authenticationRequired={true}\n                doLogout={doLogout}\n                enableDebugLog={true}\n                onTokenObtained={(data) => setTokenLoaded(data)}\n                onTokenObtainedError={(error) => setTokenLoaded(error)}\n              >\n                <Switch>\n                  <Route path='/authrequired'>\n                    <h3>Auth Required</h3>\n                    <span style={{fontStyle: 'italic'}}>\n                      This page requires you to be logged in. It's content only shows when you are logged in.\n                    </span>\n                    {loginstatus}\n                    {pageinfo}\n                  </Route>\n                  <Route path='/callback'>\n                    {/* callback route */}\n                  </Route>\n                </Switch>\n              </AuthCodeProvider>\n              \n            </Route>\n          </Switch>\n      </div>\n    </div>\n  )\n\n}\n\nexport default withRouter(App)\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport 'bootstrap/dist/css/bootstrap.css'\nimport { BrowserRouter as Router} from 'react-router-dom';\n\nReactDOM.render(<Router><App /></Router>, document.getElementById('root'))\n"],"sourceRoot":""}